window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame;Fluid.utils={listenScroll:function(a){var b=new Debouncer(a);window.addEventListener("scroll",b,false);b.handleEvent();return b},unlistenScroll:function(a){window.removeEventListener("scroll",a)},scrollToElement:function(c,b){var a=jQuery(c).offset();if(a){jQuery("html,body").animate({scrollTop:a.top+(b||0),easing:"swing"})}},elementVisible:function(a,c){c=c&&c>=0?c:0;var d=a.getBoundingClientRect();var b=window.innerHeight||document.documentElement.clientHeight;var e=d.top;return(e>=0&&e<=b*(c+1))||(e<=0&&e>=-(b*c)-d.height)},waitElementVisible:function(e,a,c){var d=typeof window!=="undefined";var b=(d&&!("onscroll" in window))||(typeof navigator!=="undefined"&&/(gle|ing|ro|msn)bot|crawl|spider|yand|duckgo/i.test(navigator.userAgent));if(!d||b){return}c=c&&c>=0?c:0;function f(g){if(Fluid.utils.elementVisible(g,c)){a();return}if("IntersectionObserver" in window){var h=new IntersectionObserver(function(j,k){if(j[0].isIntersecting){a();k.disconnect()}},{threshold:[0],rootMargin:(window.innerHeight||document.documentElement.clientHeight)*c+"px"});h.observe(g)}else{var i=Fluid.utils.listenScroll(function(){if(Fluid.utils.elementVisible(g,c)){Fluid.utils.unlistenScroll(i);a()}})}}if(typeof e==="string"){this.waitElementLoaded(e,function(g){f(g)})}else{f(e)}},waitElementLoaded:function(e,a){var d=typeof window!=="undefined";var b=(d&&!("onscroll" in window))||(typeof navigator!=="undefined"&&/(gle|ing|ro|msn)bot|crawl|spider|yand|duckgo/i.test(navigator.userAgent));if(!d||b){return}if("MutationObserver" in window){var c=new MutationObserver(function(h,g){var f=document.querySelector(e);if(f){a(f);g.disconnect()}});c.observe(document,{childList:true,subtree:true})}else{document.addEventListener("DOMContentLoaded",function(){var f=function(){var g=document.querySelector(e);if(g){a(g)}else{setTimeout(f,100)}};f()})}},createScript:function(f,b){var c=document.createElement("script");c.setAttribute("src",f);c.setAttribute("type","text/javascript");c.setAttribute("charset","UTF-8");c.async=false;if(typeof b==="function"){if(window.attachEvent){c.onreadystatechange=function(){var g=c.readyState;if(g==="loaded"||g==="complete"){c.onreadystatechange=null;b()}}}else{c.onload=b}}var d=document.getElementsByTagName("script");var a=d.length>0?d[d.length-1]:document.head||document.documentElement;a.parentNode.insertBefore(c,a.nextSibling)},createCssLink:function(c){var b=document.createElement("link");b.setAttribute("rel","stylesheet");b.setAttribute("type","text/css");b.setAttribute("href",c);var a=document.getElementsByTagName("link")[0]||document.getElementsByTagName("head")[0]||document.head||document.documentElement;a.parentNode.insertBefore(b,a)},loadComments:function(d,c){var b=document.querySelector("#comments[lazyload]");if(b){var a=function(){c();b.removeAttribute("lazyload")};Fluid.utils.waitElementVisible(d,a,CONFIG.lazyload.offset_factor)}else{c()}},getBackgroundLightness:function(d){var b=d;if(typeof d==="string"){b=document.querySelector(d)}var e=b.ownerDocument.defaultView;if(!e){e=window}var c=e.getComputedStyle(b).backgroundColor.replace(/rgba*\(/,"").replace(")","").split(/,\s*/);if(c.length<3){return 0}var a=(0.213*c[0])+(0.715*c[1])+(0.072*c[2]);return a===0||a>255/2?1:-1},retry:function(a,b,d){if(d<=0){return}var c=function(){if(--d>=0&&!a()){setTimeout(c,b)}};setTimeout(c,b)},};function Debouncer(a){this.callback=a;this.ticking=false}Debouncer.prototype={constructor:Debouncer,update:function(){this.callback&&this.callback();this.ticking=false},requestTick:function(){if(!this.ticking){requestAnimationFrame(this.rafCallback||(this.rafCallback=this.update.bind(this)));this.ticking=true}},handleEvent:function(){this.requestTick()}};